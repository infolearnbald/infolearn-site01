<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Verificar E-mail — InfoLearn</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="topbar"><div class="brand"><div class="logo">InfoLearn Academy</div></div></header>
  <main class="container">
    <section class="card">
      <h2>Verifique o seu e-mail</h2>
      <p class="muted">Enviámos um e-mail com um link de verificação. Clique no link para ativar a sua conta. Se não chegou, pode reenviar abaixo.</p>
      <div>
        <button id="resend" class="btn">Reenviar e-mail de verificação</button>
        <button id="logout" class="btn secondary">Sair</button>
      </div>
      <div id="status" style="margin-top:10px" class="muted"></div>
    </section>
  </main>

  <script type="module">
    import { auth } from './firebase.js';
    import { onAuthStateChanged, sendEmailVerification, signOut } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

    let currentUser = null;
    onAuthStateChanged(auth, (user) => {
      currentUser = user;
      if(!user) { document.getElementById('status').innerText = 'Nenhum utilizador autenticado.'; return; }
      document.getElementById('status').innerText = 'E-mail: ' + user.email + ' (aguardando verificação)';
    });

    document.getElementById('resend').addEventListener('click', async ()=>{
      if(!currentUser){ alert('Faça login primeiro para reenviar.'); window.location.href='login.html'; return; }
      await sendEmailVerification(currentUser);
      alert('E-mail de verificação reenviado. Verifique a sua caixa de entrada.');
    });

    document.getElementById('logout').addEventListener('click', async ()=>{
      await signOut(auth);
      window.location.href = 'login.html';
    });
  </script>
</body>
</html>
