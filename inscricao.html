<!DOCTYPE html>
<html lang="pt">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Inscrição — InfoLearn</title><link rel="stylesheet" href="style.css"></head>
<body>
<header class="topbar"><div class="brand"><img src="icon-192.png" width="48"><div><div class="logo">InfoLearn Academy</div></div></div></header>
<main class="container"><section class="card"><h2>Inscrição</h2>
<form id="enroll" class="form-grid">
  <input id="curso" readonly>
  <input id="nome" placeholder="Nome completo" required>
  <input id="email" placeholder="Email" type="email" required>
  <input id="phone" placeholder="Telefone (ex: 2588...)" required>
  <input id="idade" type="number" placeholder="Idade" min="10" max="120" required>
  <select id="genero" required><option value="">Gênero</option><option>Masculino</option><option>Feminino</option><option>Outro</option></select>
  <input id="provincia" placeholder="Província" required>
  <select id="duracao"><option>1 mês</option><option>3 meses</option></select>
  <button class="btn" type="submit">Confirmar e Abrir WhatsApp</button>
</form>
</section></main>
<script type="module">
import { db } from './firebase.js';
import { addDoc, collection, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";
const params=new URLSearchParams(location.search); const curso=params.get('curso')||'Curso InfoLearn'; document.getElementById('curso').value=curso;
function mapWA(course){ course=course.toLowerCase(); if(course.includes('ingl')) return '258874094875'; if(course.includes('mus')) return '258857521281'; if(course.includes('design')) return '258867101103'; return '258844180213'; }
document.getElementById('enroll').addEventListener('submit', async e=>{ e.preventDefault(); const nome=document.getElementById('nome').value; const email=document.getElementById('email').value; const phone=document.getElementById('phone').value; const idade=document.getElementById('idade').value; const genero=document.getElementById('genero').value; const provincia=document.getElementById('provincia').value; const duracao=document.getElementById('duracao').value;
try{ await addDoc(collection(db,'enrolments'),{curso,nome,email,phone,idade,genero,provincia,duracao,createdAt:serverTimestamp(),status:'pending'}); }catch(e){ console.warn(e); }
const wa=mapWA(curso); const msg=`Olá, quero me inscrever em ${curso}. Nome: ${nome}. Idade:${idade}. Gênero:${genero}. Província:${provincia}. Duração:${duracao}. Email:${email}. Telefone:${phone}`; window.open(`https://wa.me/${wa}?text=${encodeURIComponent(msg)}`,'_blank');
});
</script>
</body>
</html>
